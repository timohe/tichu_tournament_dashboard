{"ast":null,"code":"import { Observable, throwError } from 'rxjs';\nimport { TournamentBestlistResponse, TournamentRankingEntry } from '../types';\nimport { SERVER_URL } from '../../environments/environment';\nimport { HttpClient } from '@angular/common/http';\nimport { catchError } from 'rxjs/operators';\nimport { ToastController } from '@ionic/angular';\nimport { ToastService } from '../helperServices/toast.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { ActivatedRoute } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@ngx-translate/core\";\nimport * as i3 from \"../helperServices/toast.service\";\nimport * as i4 from \"@angular/common/http\";\nimport * as i5 from \"@ionic/angular\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"./tournament-dashboard-tile/tournament-dashboard-tile.component\";\n\nfunction TournamentDashboardPage_ion_icon_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 5);\n  }\n}\n\nfunction TournamentDashboardPage_ion_icon_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-icon\", 6);\n  }\n}\n\nfunction TournamentDashboardPage_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"h1\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-grid\");\n    i0.ɵɵelementStart(4, \"ion-row\");\n    i0.ɵɵelementStart(5, \"ion-col\", 7);\n    i0.ɵɵelement(6, \"app-tournament-dashboard-tile\", 8);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ion-col\", 7);\n    i0.ɵɵelement(9, \"app-tournament-dashboard-tile\", 9);\n    i0.ɵɵpipe(10, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ion-col\", 7);\n    i0.ɵɵelement(12, \"app-tournament-dashboard-tile\", 10);\n    i0.ɵɵpipe(13, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"ion-col\", 7);\n    i0.ɵɵelement(15, \"app-tournament-dashboard-tile\", 11);\n    i0.ɵɵpipe(16, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"ion-col\", 7);\n    i0.ɵɵelement(18, \"app-tournament-dashboard-tile\", 12);\n    i0.ɵɵpipe(19, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"ion-col\", 7);\n    i0.ɵɵelement(21, \"app-tournament-dashboard-tile\", 13);\n    i0.ɵɵpipe(22, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"ion-col\", 7);\n    i0.ɵɵelement(24, \"app-tournament-dashboard-tile\", 14);\n    i0.ɵɵpipe(25, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"ion-col\", 7);\n    i0.ɵɵelement(27, \"app-tournament-dashboard-tile\", 15);\n    i0.ɵɵpipe(28, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.tournamentName);\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(7, 17, \"statistics.tichuMaster\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(10, 19, \"statistics.tichuAnnouncedWhen1stRate\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(13, 21, \"statistics.winRate\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(16, 23, \"statistics.bombRate\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(19, 25, \"statistics.doubleWinRate\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(22, 27, \"statistics.tichuPreventedRate\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(25, 29, \"statistics.tichuSuccessRate\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"statName\", i0.ɵɵpipeBind1(28, 31, \"statistics.bigTichuSuccessRate\"));\n    i0.ɵɵproperty(\"bestList\", ctx_r2.activeTournamentBestlist);\n  }\n}\n\nfunction TournamentDashboardPage_div_6_div_13_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 25);\n    i0.ɵɵelementStart(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-label\", 19);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-label\", 20);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-label\", 21);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ranking_r6 = ctx.$implicit;\n    const i_r7 = ctx.index;\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i_r7 + 1, \". \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\" \", ranking_r6.player1Name, \" \", ctx_r5.teamGameAndSymbol, \" \", ranking_r6.player2Name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ranking_r6.winpointsPerRound, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ranking_r6.pointDifference, \" \");\n  }\n}\n\nfunction TournamentDashboardPage_div_6_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtemplate(1, TournamentDashboardPage_div_6_div_13_ion_item_1_Template, 9, 6, \"ion-item\", 24);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.activeTournamentRanking);\n  }\n}\n\nfunction TournamentDashboardPage_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"h1\");\n    i0.ɵɵtext(2, \"Leaderboard\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 16);\n    i0.ɵɵelementStart(4, \"ion-item\", 17);\n    i0.ɵɵelementStart(5, \"ion-label\", 18);\n    i0.ɵɵtext(6, \" Rank \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-label\", 19);\n    i0.ɵɵtext(8, \" Players \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"ion-label\", 20);\n    i0.ɵɵtext(10, \" Winpoints/Round \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ion-label\", 21);\n    i0.ɵɵtext(12, \" Point-Difference \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, TournamentDashboardPage_div_6_div_13_Template, 2, 1, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.activeTournamentRanking);\n  }\n} // http://localhost:8100/tournament-dashboard?tournamentName=test\n\n\nexport let TournamentDashboardPage = /*#__PURE__*/(() => {\n  class TournamentDashboardPage {\n    constructor(route, translator, toastService, httpClient, toastController) {\n      this.route = route;\n      this.translator = translator;\n      this.toastService = toastService;\n      this.httpClient = httpClient;\n      this.toastController = toastController;\n      this.activeTournamentBestlist = null;\n      this.activeTournamentRanking = null;\n    }\n\n    ngOnInit() {\n      this.route.queryParams.subscribe(params => {\n        if (params) {\n          this.tournamentName = params.tournamentName;\n          this.refreshActiveTournament(this.tournamentName); // refresh every 15 seconds\n\n          const x = setInterval(() => {\n            this.refreshActiveTournament(this.tournamentName);\n          }, 30000);\n        }\n      });\n    }\n\n    refreshActiveTournament(name) {\n      this.APIGetTournamentBestlistByName(name).subscribe(bestlist => {\n        this.activeTournamentBestlist = bestlist;\n      });\n      this.APIGetTournamentRanking(name).subscribe(ranking => {\n        this.activeTournamentRanking = ranking;\n\n        if (ranking[0].player2Id) {\n          this.teamGameAndSymbol = '&';\n        }\n      });\n    }\n\n    toggleShowLeaderboard() {\n      this.showLeaderboard = !this.showLeaderboard;\n    }\n\n    APIGetTournamentBestlistByName(tournamentName) {\n      return this.httpClient.get(`${SERVER_URL}/tournament/tournamentBestListbyName/${tournamentName}`).pipe(catchError(err => {\n        this.toastService.presentToast();\n        return throwError(err);\n      }));\n    }\n\n    APIGetTournamentRanking(tournamentName) {\n      return this.httpClient.get(`${SERVER_URL}/tournament/ranking/${tournamentName}`).pipe(catchError(err => {\n        this.toastService.presentToast();\n        return throwError(err);\n      }));\n    }\n\n  }\n\n  TournamentDashboardPage.ɵfac = function TournamentDashboardPage_Factory(t) {\n    return new (t || TournamentDashboardPage)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.TranslateService), i0.ɵɵdirectiveInject(i3.ToastService), i0.ɵɵdirectiveInject(i4.HttpClient), i0.ɵɵdirectiveInject(i5.ToastController));\n  };\n\n  TournamentDashboardPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TournamentDashboardPage,\n    selectors: [[\"app-tournament-dashboard\"]],\n    decls: 7,\n    vars: 4,\n    consts: [[1, \"top-spacer\"], [\"color\", \"primary\", 1, \"leaderboard-toggle\", 3, \"click\"], [\"class\", \"toggle-icon\", \"name\", \"trophy\", 4, \"ngIf\"], [\"class\", \"toggle-icon\", \"name\", \"podium\", 4, \"ngIf\"], [4, \"ngIf\"], [\"name\", \"trophy\", 1, \"toggle-icon\"], [\"name\", \"podium\", 1, \"toggle-icon\"], [\"sizeLg\", \"3\", \"sizeMd\", \"4\", \"sizeXs\", \"6\"], [\"propertyName\", \"tichuMaster\", \"showPercentage\", \"\", 3, \"statName\", \"bestList\"], [\"propertyName\", \"tichuAnnouncedWhen1stRate\", \"showPercentage\", \"%\", 3, \"bestList\", \"statName\"], [\"showPercentage\", \"%\", \"propertyName\", \"winRate\", 3, \"bestList\", \"statName\"], [\"showPercentage\", \"%\", \"propertyName\", \"bombRate\", 3, \"bestList\", \"statName\"], [\"showPercentage\", \"%\", \"propertyName\", \"doubleWinRate\", 3, \"bestList\", \"statName\"], [\"showPercentage\", \"%\", \"propertyName\", \"tichuPreventedRate\", 3, \"bestList\", \"statName\"], [\"showPercentage\", \"%\", \"propertyName\", \"tichuSuccessRate\", 3, \"bestList\", \"statName\"], [\"howPercentage\", \"%\", \"propertyName\", \"bigTichuSuccessRate\", 3, \"bestList\", \"statName\"], [1, \"leaderboard-container\"], [\"lines\", \"none\", \"detail\", \"false\", 1, \"leaderboard\", \"header\"], [1, \"rank\"], [1, \"users\"], [1, \"winpoints\"], [1, \"difference\"], [\"class\", \"leaderboard list\", 4, \"ngIf\"], [1, \"leaderboard\", \"list\"], [\"lines\", \"none\", \"detail\", \"false\", 4, \"ngFor\", \"ngForOf\"], [\"lines\", \"none\", \"detail\", \"false\"]],\n    template: function TournamentDashboardPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-content\");\n        i0.ɵɵelement(1, \"div\", 0);\n        i0.ɵɵelementStart(2, \"ion-button\", 1);\n        i0.ɵɵlistener(\"click\", function TournamentDashboardPage_Template_ion_button_click_2_listener() {\n          return ctx.toggleShowLeaderboard();\n        });\n        i0.ɵɵtemplate(3, TournamentDashboardPage_ion_icon_3_Template, 1, 0, \"ion-icon\", 2);\n        i0.ɵɵtemplate(4, TournamentDashboardPage_ion_icon_4_Template, 1, 0, \"ion-icon\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(5, TournamentDashboardPage_div_5_Template, 29, 33, \"div\", 4);\n        i0.ɵɵtemplate(6, TournamentDashboardPage_div_6_Template, 14, 1, \"div\", 4);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", !ctx.showLeaderboard);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showLeaderboard);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.showLeaderboard);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showLeaderboard);\n      }\n    },\n    directives: [i5.IonContent, i5.IonButton, i6.NgIf, i5.IonIcon, i5.IonGrid, i5.IonRow, i5.IonCol, i7.TournamentDashboardTileComponent, i5.IonItem, i5.IonLabel, i6.NgForOf],\n    pipes: [i2.TranslatePipe],\n    styles: [\"ion-content[_ngcontent-%COMP%]{--ion-background-color: var(--ion-color-background)}h1[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-align:center;vertical-align:center!important;margin:0;font-size:4em}.leaderboard-toggle[_ngcontent-%COMP%]{position:absolute;right:15%;width:5em;height:5em;text-align:center;color:#fff}.toggle-icon[_ngcontent-%COMP%]{font-size:4em}.leaderboard-container[_ngcontent-%COMP%]{margin-top:4em;display:flex;flex-direction:column;flex-wrap:nowrap;align-items:center;align-content:stretch;height:90vh}.leaderboard[_ngcontent-%COMP%]{width:100%}.rank[_ngcontent-%COMP%]{flex-grow:1}.users[_ngcontent-%COMP%]{flex-grow:5}.winpoints[_ngcontent-%COMP%], .difference[_ngcontent-%COMP%]{flex-grow:3}.list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:first-child{--background: #ffe460;color:#000}.list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(2){--background: #b5b3b3;color:#000}.list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(3){--background: #cd7f32;color:#000}.header[_ngcontent-%COMP%]{--background: var(--ion-color-background);color:#000;margin-top:.3rem;border-radius:8px;--border-color: rgba(255, 255, 255, .9);--color-hover: white !important;--color-activated: white !important;--color-focused: white !important}ion-label[_ngcontent-%COMP%]{font-size:2rem!important;padding:0!important;margin:0!important}h2[_ngcontent-%COMP%]{text-align:center;vertical-align:center!important;margin:0 0 0 5%}\"]\n  });\n  return TournamentDashboardPage;\n})();","map":null,"metadata":{},"sourceType":"module"}