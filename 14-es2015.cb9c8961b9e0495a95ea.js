(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{BHKt:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var i=n("mrSG"),o=n("z6cu"),r=n("JIr8"),s=n("NEhk"),c=n("TEn/"),a=n("AytR"),l=n("fXoL"),b=n("sYmb"),h=n("tk/3"),g=n("ofXK");function u(e,t){1&e&&(l.Qb(0,"h4"),l.wc(1,"Search Results"),l.Pb())}function d(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item",4),l.Yb("click",(function(){l.pc(e);const n=t.$implicit;return l.ac().addUserToWhitelist(n)})),l.Mb(1,"div",5),l.Qb(2,"ion-label"),l.wc(3),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit;l.Bb(3),l.yc(" ",null==e?null:e.name," ")}}function p(e,t){1&e&&(l.Qb(0,"h4"),l.wc(1),l.bc(2,"translate"),l.Pb()),2&e&&(l.Bb(1),l.xc(l.cc(2,1,"profile.whitelist")))}function f(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item-sliding",7),l.Mb(1,"div",5),l.Qb(2,"ion-item"),l.Mb(3,"div",5),l.Qb(4,"ion-label"),l.wc(5),l.Pb(),l.Pb(),l.Qb(6,"ion-item-options",8),l.Mb(7,"div",5),l.Qb(8,"button",9),l.Yb("click",(function(){l.pc(e);const n=t.$implicit;return l.ac(2).removeUserFromWhitelist(n)})),l.Mb(9,"ion-icon",10),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit;l.Bb(5),l.yc(" ",null==e?null:e.name," ")}}function m(e,t){if(1&e&&(l.Qb(0,"ion-list"),l.uc(1,f,10,1,"ion-item-sliding",6),l.Pb()),2&e){const e=l.ac();l.Bb(1),l.gc("ngForOf",e.whitelist)}}let P=(()=>{class e{constructor(e,t,n,i){this.translator=e,this.toastService=t,this.modalController=n,this.httpClient=i}ngOnInit(){this.refreshWhitelistOfUser(),setTimeout(()=>{this.searchbar.setFocus()},1e3)}discardModal(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.modalController.dismiss()}))}closeModal(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.modalController.dismiss()}))}searchForUser(e,t){return this.httpClient.post(a.b+"/users/search",{name:e,email:t}).pipe(Object(r.a)(e=>(this.toastService.presentToast(),Object(o.a)(e))))}onSearchTerm(e){const t=e.detail.value;this.searchForUser(t,t).subscribe(e=>{this.searchResults=e})}refreshWhitelistOfUser(){this.APIgetLoggedInUser().subscribe(e=>{const t=e.whitelist;t.sort((e,t)=>e.name.localeCompare(t.name)),this.whitelist=t,console.log("This is the data"),console.log(e.whitelist)})}addUserToWhitelist(e){this.APIaddToWhitelist(e.id).subscribe(e=>{const t=e.whitelist;t.sort((e,t)=>e.name.localeCompare(t.name)),this.whitelist=t,this.searchResults=null})}removeUserFromWhitelist(e){console.log("addUserToWhitelist"),this.APIremoveFromWhitelist(e.id).subscribe(e=>{this.whitelist=e.whitelist})}APIgetLoggedInUser(){return this.httpClient.get(a.b+"/users/loggedInUser").pipe(Object(r.a)(e=>(this.toastService.presentToast(),Object(o.a)(e))))}APIaddToWhitelist(e){return this.httpClient.post(a.b+"/users/addToWhitelist",{id:e}).pipe(Object(r.a)(e=>(e.error.userAlreadyOnWhiteListError?this.toastService.presentToast(this.translator.instant("profile.toast_userAlreadyOnWhiteListError")):this.toastService.presentToast(),Object(o.a)(e))))}APIremoveFromWhitelist(e){return this.httpClient.post(a.b+"/users/removeFromWhitelist",{id:e}).pipe(Object(r.a)(e=>(this.toastService.presentToast(),Object(o.a)(e))))}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(b.d),l.Lb(s.a),l.Lb(c.S),l.Lb(h.b))},e.\u0275cmp=l.Fb({type:e,selectors:[["app-whitelist-modal"]],viewQuery:function(e,t){var n;1&e&&l.Cc(c.F,!0),2&e&&l.mc(n=l.Zb())&&(t.searchbar=n.first)},decls:8,vars:7,consts:[[1,"inner-content"],[3,"placeholder","ionChange"],[4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["tabindex","0"],["button","",4,"ngFor","ngForOf"],["button",""],["side","end"],["ion-button","","color","danger",1,"slide-button",3,"click"],["name","trash"]],template:function(e,t){1&e&&(l.Qb(0,"div",0),l.Qb(1,"ion-searchbar",1),l.Yb("ionChange",(function(e){return t.onSearchTerm(e)})),l.bc(2,"translate"),l.Pb(),l.uc(3,u,2,0,"h4",2),l.Qb(4,"ion-list"),l.uc(5,d,4,1,"ion-item",3),l.Pb(),l.uc(6,p,3,3,"h4",2),l.uc(7,m,2,1,"ion-list",2),l.Pb()),2&e&&(l.Bb(1),l.hc("placeholder",l.cc(2,5,"game.search_placeholder")),l.Bb(2),l.gc("ngIf",t.searchResults&&t.searchResults.length>0),l.Bb(2),l.gc("ngForOf",t.searchResults),l.Bb(1),l.gc("ngIf",!t.searchResults||t.searchResults.length<1),l.Bb(1),l.gc("ngIf",!t.searchResults||t.searchResults.length<1))},directives:[c.F,c.Y,g.j,c.y,g.i,c.u,c.x,c.w,c.v,c.s],pipes:[b.c],styles:["h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{text-align:center}.slide-button[_ngcontent-%COMP%]{width:15vw;background-color:var(--ion-color-primary);font-size:1.4rem;color:#fff}ion-button[_ngcontent-%COMP%]{color:var(--ion-color-primaty)}ion-item[_ngcontent-%COMP%]{--background:#fff;color:#000}.inner-content[_ngcontent-%COMP%]{max-height:50vh!important}"]}),e})()},cRhG:function(e,t,n){"use strict";n.r(t),n.d(t,"ProfilePageModule",(function(){return _}));var i=n("ofXK"),o=n("3Pt+"),r=n("TEn/"),s=n("tyNb"),c=n("mrSG"),a=n("z6cu"),l=(n("t4lL"),n("AytR")),b=n("JIr8"),h=n("wd/R"),g=n("NEhk"),u=n("BHKt"),d=n("gcOT"),p=n("fXoL"),f=n("sYmb"),m=n("tk/3"),P=n("e8h1");function v(e,t){if(1&e){const e=p.Rb();p.Qb(0,"img",13),p.Yb("click",(function(){return p.pc(e),p.ac().uploadImage()})),p.Pb()}if(2&e){const e=p.ac();p.gc("src","data:image/jpeg;base64,"+e.profilePicture.img,p.rc)}}function w(e,t){if(1&e){const e=p.Rb();p.Qb(0,"img",14),p.Yb("click",(function(){return p.pc(e),p.ac().uploadImage()})),p.Pb()}}function C(e,t){if(1&e){const e=p.Rb();p.Qb(0,"ion-list"),p.Qb(1,"ion-item",15),p.Yb("click",(function(){return p.pc(e),p.ac().openWhitelistSearchModal()})),p.Qb(2,"ion-label"),p.wc(3),p.bc(4,"translate"),p.Pb(),p.Pb(),p.Qb(5,"ion-item",16),p.Qb(6,"ion-label"),p.wc(7),p.bc(8,"translate"),p.Pb(),p.Pb(),p.Qb(9,"ion-item",15),p.Yb("click",(function(){return p.pc(e),p.ac().togglePasswordChangeActive()})),p.Qb(10,"ion-label"),p.wc(11),p.bc(12,"translate"),p.Pb(),p.Pb(),p.Qb(13,"ion-item",17),p.Qb(14,"ion-label"),p.wc(15),p.Pb(),p.Pb(),p.Qb(16,"ion-item",18),p.Yb("click",(function(){return p.pc(e),p.ac().logout()})),p.Qb(17,"ion-label"),p.wc(18),p.bc(19,"translate"),p.Pb(),p.Pb(),p.Pb()}if(2&e){const e=p.ac();p.Bb(3),p.yc(" ",p.cc(4,6,"profile.whitelist")," "),p.Bb(4),p.yc(" ",p.cc(8,8,"profile.faq")," "),p.Bb(4),p.yc(" ",p.cc(12,10,"profile.password")," "),p.Bb(4),p.zc(" Version: ",e.appVersion," (#",e.appBuild,") "),p.Bb(3),p.yc(" ",p.cc(19,12,"profile.logout")," ")}}function M(e,t){if(1&e){const e=p.Rb();p.Qb(0,"div"),p.Qb(1,"ion-list"),p.Qb(2,"ion-item",19),p.Mb(3,"div",20),p.Qb(4,"ion-label",21),p.wc(5),p.bc(6,"translate"),p.Pb(),p.Qb(7,"ion-input",22),p.Yb("ngModelChange",(function(t){return p.pc(e),p.ac().emailToSet1=t})),p.Pb(),p.Pb(),p.Qb(8,"ion-item",19),p.Mb(9,"div",20),p.Qb(10,"ion-label",21),p.wc(11),p.bc(12,"translate"),p.Pb(),p.Qb(13,"ion-input",22),p.Yb("ngModelChange",(function(t){return p.pc(e),p.ac().emailToSet2=t})),p.Pb(),p.Pb(),p.Pb(),p.Qb(14,"ion-button",23),p.Yb("click",(function(){return p.pc(e),p.ac().changeEmail()})),p.wc(15),p.bc(16,"translate"),p.Pb(),p.Qb(17,"ion-button",24),p.Yb("click",(function(){return p.pc(e),p.ac().toggleEmailChangeActive()})),p.wc(18),p.bc(19,"translate"),p.Pb(),p.Pb()}if(2&e){const e=p.ac();p.Bb(5),p.xc(p.cc(6,6,"profile.new_email")),p.Bb(2),p.gc("ngModel",e.emailToSet1),p.Bb(4),p.xc(p.cc(12,8,"profile.repeat")),p.Bb(2),p.gc("ngModel",e.emailToSet2),p.Bb(2),p.yc("",p.cc(16,10,"profile.save")," "),p.Bb(3),p.yc("",p.cc(19,12,"profile.cancel")," ")}}function O(e,t){if(1&e){const e=p.Rb();p.Qb(0,"ion-list"),p.Qb(1,"ion-item",19),p.Mb(2,"div",20),p.Qb(3,"ion-label",21),p.wc(4),p.bc(5,"translate"),p.Pb(),p.Qb(6,"ion-input",25),p.Yb("ngModelChange",(function(t){return p.pc(e),p.ac(2).passwordToSet1=t})),p.Pb(),p.Pb(),p.Qb(7,"ion-item",19),p.Mb(8,"div",20),p.Qb(9,"ion-label",21),p.wc(10),p.bc(11,"translate"),p.Pb(),p.Qb(12,"ion-input",25),p.Yb("ngModelChange",(function(t){return p.pc(e),p.ac(2).passwordToSet2=t})),p.Pb(),p.Pb(),p.Pb()}if(2&e){const e=p.ac(2);p.Bb(4),p.xc(p.cc(5,4,"profile.new_password")),p.Bb(2),p.gc("ngModel",e.passwordToSet1),p.Bb(4),p.xc(p.cc(11,6,"profile.repeat")),p.Bb(2),p.gc("ngModel",e.passwordToSet2)}}function I(e,t){if(1&e){const e=p.Rb();p.Qb(0,"div"),p.uc(1,O,13,8,"ion-list",12),p.Qb(2,"ion-button",23),p.Yb("click",(function(){return p.pc(e),p.ac().changePassword()})),p.wc(3),p.bc(4,"translate"),p.Pb(),p.Qb(5,"ion-button",24),p.Yb("click",(function(){return p.pc(e),p.ac().togglePasswordChangeActive()})),p.wc(6),p.bc(7,"translate"),p.Pb(),p.Pb()}if(2&e){const e=p.ac();p.Bb(1),p.gc("ngIf",e.passwordChangeActive),p.Bb(2),p.yc("",p.cc(4,3,"profile.save")," "),p.Bb(3),p.yc(" ",p.cc(7,5,"profile.cancel")," ")}}const{Camera:Q}=d.d,y=[{path:"",component:(()=>{class e{constructor(e,t,n,i,o,r,c){this.modalController=e,this.translateService=t,this.toastService=n,this.httpClient=i,this.storage=o,this.router=r,this.toastController=c,this.emailChangeActive=!1,this.passwordChangeActive=!1,this.currentLanguage=this.translateService.currentLang,this.appVersion="n/A",this.appBuild="n/A",this.profilePicture=null,this.router.events.subscribe(e=>{e instanceof s.c&&"/tabs/profile"===e.url&&this.refreshUser()}),t.onLangChange.subscribe(e=>{console.log("lang changed detected",e)}),this.storage.get("APP_VERSION").then(e=>{this.appVersion=e},e=>console.error(e)),this.storage.get("APP_BUILD").then(e=>{this.appBuild=e},e=>console.error(e))}ngOnInit(){this.APIgetImage().subscribe(e=>{e.img&&(this.profilePicture=e)})}refreshUser(){this.APIgetLoggedInUser().subscribe(e=>{this.loggedInUser=e,this.loggedInUser.date=h(this.loggedInUser.date).format("DD.MM.YYYY")})}APIgetLoggedInUser(){return this.httpClient.get(l.b+"/users/loggedInUser").pipe(Object(b.a)(e=>(this.toastService.presentToast(),Object(a.a)(e))))}logout(){return Object(c.a)(this,void 0,void 0,(function*(){yield this.storage.remove("USER_ID"),yield this.storage.remove("USER_NAME"),yield this.storage.remove("USER_EMAIL"),yield this.storage.remove("ACCESS_TOKEN"),yield this.storage.remove("EXPIRES_IN"),this.router.navigateByUrl("login")}))}APIchangePassword(){return this.httpClient.post(l.b+"/users/changePassword",{newPassword1:this.passwordToSet1,newPassword2:this.passwordToSet2}).pipe(Object(b.a)(e=>(this.toastService.presentToast(),Object(a.a)(e))))}changePassword(){this.APIchangePassword().subscribe(e=>{console.log(e),this.togglePasswordChangeActive(),this.toastService.presentToast(this.translateService.instant("profile.password_changed")),this.refreshUser()})}APIchangeEmail(){return this.httpClient.post(l.b+"/users/changeEmail",{newEmail1:this.emailToSet1,newEmail2:this.emailToSet2}).pipe(Object(b.a)(e=>(this.toastService.presentToast(this.translateService.instant("profile.invalid_email")),Object(a.a)(e))))}changeEmail(){this.APIchangeEmail().subscribe(e=>{console.log(e),this.toggleEmailChangeActive(),this.toastService.presentToast(),this.refreshUser()})}toggleEmailChangeActive(){this.emailChangeActive=!this.emailChangeActive}togglePasswordChangeActive(){this.passwordChangeActive=!this.passwordChangeActive}onLanguageChange(e){this.currentLanguage=e.target.value,this.translateService.use(this.currentLanguage)}openWhitelistSearchModal(){return Object(c.a)(this,void 0,void 0,(function*(){const e=yield this.modalController.create({component:u.a,cssClass:"auto-height bottom-sheet",showBackdrop:!0,mode:"ios",componentProps:{}});return e.onDidDismiss().then(()=>{}),yield e.present()}))}uploadImage(){return Object(c.a)(this,void 0,void 0,(function*(){const e=yield Q.getPhoto({quality:60,allowEditing:!1,resultType:d.a.Base64,source:d.b.Photos,width:100,height:100,preserveAspectRatio:!1});this.APIuploadImage(e.base64String).subscribe(e=>{this.profilePicture=e})}))}APIuploadImage(e){return this.httpClient.post(l.b+"/users/profilePicture",{picture:e}).pipe(Object(b.a)(e=>(this.toastService.presentToast(),Object(a.a)(e))))}APIgetImage(){return this.httpClient.get(l.b+"/users/profilePicture").pipe(Object(b.a)(e=>(this.toastService.presentToast(),Object(a.a)(e))))}}return e.\u0275fac=function(t){return new(t||e)(p.Lb(r.S),p.Lb(f.d),p.Lb(g.a),p.Lb(m.b),p.Lb(P.b),p.Lb(s.h),p.Lb(r.Z))},e.\u0275cmp=p.Fb({type:e,selectors:[["app-profile"]],decls:22,vars:11,consts:[[1,"top-spacer"],[1,"horizontal-margin"],[1,"profile-header"],[3,"src","click",4,"ngIf"],["src","../../assets/icon/avatars/avatar_dragon_orange.png",3,"click",4,"ngIf"],[1,"profile-details"],[1,"name"],[3,"click"],["placeholder","Select One",3,"value","ionChange"],["value","de"],["value","en"],[1,"list-title"],[4,"ngIf"],[3,"src","click"],["src","../../assets/icon/avatars/avatar_dragon_orange.png",3,"click"],["lines","none","button","",3,"click"],["lines","none","button","","href","https://tichustats.com/"],["lines","none",1,"noBottomBorder"],["button","","lines","none",1,"noBottomBorder",3,"click"],["lines","none"],["tabindex","0"],["position","floating"],["type","email","required","",3,"ngModel","ngModelChange"],["expand","block","color","primary",3,"click"],["expand","block",3,"click"],["type","password","required","",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(p.Qb(0,"ion-content"),p.Mb(1,"div",0),p.Qb(2,"div",1),p.Qb(3,"div",2),p.uc(4,v,1,1,"img",3),p.uc(5,w,1,0,"img",4),p.Qb(6,"div",5),p.Qb(7,"p",6),p.wc(8),p.Pb(),p.Qb(9,"p",7),p.Yb("click",(function(){return t.toggleEmailChangeActive()})),p.wc(10),p.Pb(),p.Qb(11,"ion-select",8),p.Yb("ionChange",(function(e){return t.onLanguageChange(e)})),p.Qb(12,"ion-select-option",9),p.wc(13,"Deutsch"),p.Pb(),p.Qb(14,"ion-select-option",10),p.wc(15,"English"),p.Pb(),p.Pb(),p.Pb(),p.Pb(),p.Qb(16,"p",11),p.wc(17),p.bc(18,"translate"),p.Pb(),p.uc(19,C,20,14,"ion-list",12),p.uc(20,M,20,14,"div",12),p.uc(21,I,8,7,"div",12),p.Pb(),p.Pb()),2&e&&(p.Bb(4),p.gc("ngIf",t.profilePicture),p.Bb(1),p.gc("ngIf",!t.profilePicture),p.Bb(3),p.xc(null==t.loggedInUser?null:t.loggedInUser.name),p.Bb(2),p.xc(null==t.loggedInUser?null:t.loggedInUser.email),p.Bb(1),p.hc("value",t.currentLanguage),p.Bb(6),p.xc(p.cc(18,9,"profile.settings")),p.Bb(2),p.gc("ngIf",!t.emailChangeActive&&!t.passwordChangeActive),p.Bb(1),p.gc("ngIf",t.emailChangeActive),p.Bb(1),p.gc("ngIf",t.passwordChangeActive))},directives:[r.p,i.j,r.G,r.X,r.H,r.y,r.u,r.x,r.t,r.Y,o.h,o.e,o.f,r.f],pipes:[f.c],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:var(--ion-color-background)}ion-content[_ngcontent-%COMP%]::part(background){background:url(phoenix.a6d9a2b2c790aa840f37.png) no-repeat 0 0 fixed;background-size:cover}.name[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:2rem;font-weight:500}.profile-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-start;align-items:center;align-content:stretch;margin-bottom:2rem;margin-top:1rem}.profile-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;height:100px;width:100px;margin-right:1.5em}.profile-header[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]{color:#fff;display:flex;flex-direction:column;flex-wrap:nowrap}.profile-header[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .7rem}.profile-header[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(icon){display:none!important}.profile-header[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .4rem}.profile-header[_ngcontent-%COMP%]   .profile-details[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{margin:0;padding:0}.align-right[_ngcontent-%COMP%]{text-align:right!important}.noBottomBorder[_ngcontent-%COMP%]{--border-width:0;--inner-border-width:0}a[_ngcontent-%COMP%]{text-decoration:none;color:#000}"]}),e})()},{path:"whitelist-modal",loadChildren:()=>Promise.resolve().then(n.bind(null,"ch+t")).then(e=>e.WhitelistModalPageModule)}];let B=(()=>{class e{}return e.\u0275mod=p.Jb({type:e}),e.\u0275inj=p.Ib({factory:function(t){return new(t||e)},imports:[[s.j.forChild(y)],s.j]}),e})();var S=n("ZAI4"),A=n("ch+t");let _=(()=>{class e{}return e.\u0275mod=p.Jb({type:e}),e.\u0275inj=p.Ib({factory:function(t){return new(t||e)},imports:[[i.b,o.a,r.Q,B,A.WhitelistModalPageModule,f.b.forChild({loader:{provide:f.a,useFactory:S.b,deps:[m.b]}})]]}),e})()},"ch+t":function(e,t,n){"use strict";n.r(t),n.d(t,"WhitelistModalPageModule",(function(){return g}));var i=n("ofXK"),o=n("3Pt+"),r=n("TEn/"),s=n("tyNb"),c=n("BHKt"),a=n("fXoL");const l=[{path:"",component:c.a}];let b=(()=>{class e{}return e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({factory:function(t){return new(t||e)},imports:[[s.j.forChild(l)],s.j]}),e})();var h=n("sYmb");let g=(()=>{class e{}return e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({factory:function(t){return new(t||e)},imports:[[i.b,o.a,r.Q,b,h.b.forChild()]]}),e})()}}]);